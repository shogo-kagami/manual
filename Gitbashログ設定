~/.bashrc
LOG_DIR="$HOME/Documents/logs"
LOG_BASENAME="gitbash_session"
mkdir -p "$LOG_DIR"

function start_log {
    local DATE=$(date +%Y%m%d)
    local TIME=$(date +%H%M%S)
    local LOG_FILE="${LOG_DIR}/${LOG_BASENAME}_${DATE}_${TIME}.log"

    echo "自動ログ開始: ${LOG_FILE}"

    # PROMPT_COMMAND でプロンプト表示前にログ出力
    PROMPT_COMMAND='
        tee -a "$LOG_FILE" | sed -E "s/\\e\[[^m]*m//g" | sed "/^[^[:print:]]*$/d" >&2
    '
}

# ログイン時に自動実行
start_log


ーーーーー
~/.bash_profile
# generated by Git for Windows

[[ -f ~/.bashrc ]] && source ~/.bashrc

export TERM=win32
export AWS_NO_CONSOLE_CHECK=true
alias aws='winpty aws'
export AWS_NO_TTY_WARNING=true

ーーーーー
Found xterm, while expecting a Windows console. Maybe try to run this program using "winpty" or run it in cmd.exe instead. Or otherwise, in case of Cygwin, use the Python executable that is compiled for Cygwin.

No Windows console found. Are you running cmd.exe?
export AWS_NO_CONSOLE_CHECK=true
alias aws='winpty aws'

stdout is not a tty
export TERM=win32
export AWS_NO_TTY_WARNING=true

tee: '': No such file or directory
exec > >(tee -a "$LOG_FILE" </dev/null | sed -E 's/\\e\[[^m]*m//g' | sed '/^[^[:print:]]*$/d') 2>&1

ーーーーー
LOG_DIR="$HOME/Documents/logs"
LOG_BASENAME="gitbash_session"
mkdir -p "$LOG_DIR"

function start_log {
    local DATE=$(date +%Y%m%d)
    local TIME=$(date +%H%M%S)
    local LOG_FILE="${LOG_DIR}/${LOG_BASENAME}_${DATE}_${TIME}.log"

    echo "自動ログ開始: ${LOG_FILE}"

    # 実行履歴と出力を同じログファイルに記録
    {
        while read line; do
            # コマンド行の場合（履歴番号なし）
            if [[ "$line" =~ ^[^[:space:]]+$ ]]; then
                printf '%s\n' "[CMD] $line" >> "$LOG_FILE"
            # 出力行の場合
            else
                printf '%s\n' "[OUT] $line" >> "$LOG_FILE"
            fi
        done
    } <&0
}

# ログイン時に自動実行
start_log
