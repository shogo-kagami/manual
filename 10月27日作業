モデルファイルの存在確認
cat /store/.sysonly_okeFBsTh/lustre/share/ReleaseCandidate/cksum_transfer/sbint_models.csv | cut -f 2 -d "," | xargs ls -l

コンテナファイルの存在確認
cat /store/.sysonly_okeFBsTh/lustre/share/ReleaseCandidate/cksum_transfer/container_images.csv | cut -f 2 -d "," | xargs ls -l

イメージタグの確認
cat /lustre/applications/reimei-engine-llm-serve/run_worker.slurm

・イメージタグの編集
バックアップ作成
cp -p /lustre/applications/reimei-engine-llm-serve/run_worker.slurm /lustre/applications/reimei-engine-llm-serve/run_worker.slurm.20251027
確認
ls -l /lustre/applications/reimei-engine-llm-serve/run_worker.slurm.20251027

イメージタグ修正
before=$(grep -e '--container-image' /lustre/applications/reimei-engine-llm-serve/run_worker.slurm | cut -f 2 -d "'")

echo $before

after=$(cat /store/.sysonly_okeFBsTh/lustre/share/ReleaseCandidate/cksum_transfer/container_images.csv | cut -f 2 -d ",")

echo $after

sed -i -e "s|$before|$after|" /lustre/applications/reimei-engine-llm-serve/run_worker.slurm

イメージタグの正常性確認
diff /lustre/applications/reimei-engine-llm-serve/run_worker.slurm /lustre/applications/reimei-engine-llm-serve/run_worker.slurm.20251027

grep -e '--container-image' /lustre/applications/reimei-engine-llm-serve/run_worker.slurm | cut -f 2 -d "'" | xargs ls -l


 /lustre/container_cache/reimei_engine/reimei-engine-llm-serve-gpu:90aaa01df293d761992757c0120d1d6cec8d5ce5.sqsh


タグ切り戻し
cp -p /lustre/applications/reimei-engine-llm-serve/bkup/run_worker.slurm.20251026 /lustre/applications/reimei-engine-llm-serve/run_worker.slurm

切り戻し確認
diff /lustre/applications/reimei-engine-llm-serve/run_worker.slurm /lustre/applications/reimei-engine-llm-serve/run_worker.slurm.20251027
grep -e '--container-image' /lustre/applications/reimei-engine-llm-serve/run_worker.slurm | cut -f 2 -d "'" | xargs ls -l
